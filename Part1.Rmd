---
title: "Part 1"
author: "Karol Szwed"
date: "`r Sys.Date()`"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
knitr::opts_chunk$set(cache = TRUE)

library(ggplot2)
library(reshape2)
library(caret)
library(dplyr)
library(glmnet)

```

## Eksploracja danych

```{r wczytywanie danych}
X_test <- read.csv("X_test.csv")
X_train <- read.csv("X_train.csv")
Y_train <- read.csv("y_train.csv")
```


```{r podpunkt a - ekspoatacja danych}
print("Dane treningowe - RNA")
print(dim(X_train))

print("Dane treningowe - białko powierzchniowe")
print(dim(Y_train))

print("Dane testowe")
print(dim(X_test))

# Typ zmiennych - wszystkie powinny być typu 'double'
print(all(sapply(X_test, is.double)))
print(all(sapply(X_train, is.double)))
print(all(sapply(Y_train, is.double)))

# Sprawdzenie czy są braki danych
print(any(sapply(X_test, is.na)))
print(any(sapply(X_train, is.na)))
print(any(sapply(Y_train, is.na)))
```

```{r podpunkt b - rozkład zmiennej objaśnianej}
# Badamy rozkład zmiennej objaśnianej (dane 'Y_train')
summary(Y_train)

# Histogram
ggplot(data = Y_train, aes(x = CD36)) + geom_histogram(color="black", fill="white")

# Wykres kwantylowy
ggplot(data = Y_train) + geom_qq(aes(sample = CD36), size=1.5, color="red")

```


```{r podpunkt c - korelacja zmiennych}
# Korelacja zmiennych
# Wybieramy 250 zmiennych o największej korelacji z zmienną objaśnianą
skorelowane <- apply(X_train, 2, function (x) cor(x, Y_train))
X_wybrane <- X_train[, order(skorelowane, decreasing = T)[1:250]]

# Macierz korelacji
cor_matrix <- cor(X_wybrane)
cor_relations <- melt(cor_matrix)

# Ilustrujemy wynik za pomocą mapy ciepła
install.packages("viridis")
library(viridis)
Var.heatmap <- ggplot(data = cor_relations, mapping = aes(x = Var1,
                                                          y = Var2,
                                                          fill = value)) +
  geom_tile() + scale_fill_viridis(discrete=FALSE) +
  theme(axis.text.x = element_blank(), axis.text.y = element_blank()) +
  coord_fixed()
print(Var.heatmap)
```

```{r Punkt 2 - WIP}
ggplot(data = Y_train) +
  geom_qq(aes(sample = CD36), size=1.5, color = "red") +
  geom_qq_line(aes(sample = CD36))


ks.test(Y_train, "pnorm") # Test Kolmogorova-Smiernov'a


# Wybieramy zmienne najbardziej skorelowane
correlations <- apply(X_train, 2, function (x) cor(x, Y_train))
most_correlated <- X_train[,order(correlations, decreasing = T)[1]]

# Test statystyczny hipotezy zgodności z rozkładem
ggplot() + aes(x = most_correlated) + 
  geom_histogram(binwidth = 0.1, color="blue", fill="white")

# Normalizacja danych
most_normalized <- (most_correlated - mean(most_correlated)) / sd(most_correlated)

ks.test(most_normalized, "pnorm") # Is it normal? It should be, except this pike in 0
most_cleared <- most_normalized[most_correlated > 0.2]
ks.test(most_cleared, "pnorm")



```

## Część 3 - ElasticNet

TODO - Opis modelu ElasticNet (podpunkt _a)_)

```{r - }
# Podpunkt A




```



